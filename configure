#!/usr/bin/env python3

# Configure script for LAIK:
# - tests for required/wanted packages
# - generates a Makefile.config

import sys, getopt
from pathlib import Path

defs = ""
subdirs = "examples"
ipath = "/usr/include"

# Mosquitto/MQTT
file = Path(ipath + "/mosquitto.h")
if not file.is_file():
    print("Mosquitto include file not found. MQTT disabled.")
    print("On Ubuntu, install 'libmosquitto-dev'.")
else:
    print("Mosquitto header found in " + ipath)
    defs += " -DUSE_MQTT"
    subdirs += " external/MQTT"

# write Makefile.config, will be included by Makefile
cfile = open("Makefile.config", 'w')
cfile.write("# Generated by configure.\n")
cfile.write("DEFS=" + defs + "\n")
cfile.write("SUBDIRS=" + subdirs + "\n")
cfile.close()

print("Generated 'Makefile.config'")
